% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/lvr_solve.R
\name{phaselvr}
\alias{phaselvr}
\title{Phase Field Simulation for Coupled First-Order Dynamical Systems}
\usage{
phaselvr(
  data = NULL,
  xlim = c(-5, 5),
  ylim = c(-5, 5),
  breaks = 0.5,
  lvparam = list(Lvsef1 = function(x, y) x, Lvoth1 = function(x, y) y, Lvsef2 =
    function(x, y) x, Lvoth2 = function(x, y) y),
  step_t = 1e-04,
  Times = 1,
  noise = 0,
  m = 0,
  s = 1
)
}
\arguments{
\item{data}{A numeric matrix or data frame with two columns representing initial values for the two variables.
If \code{NULL}, a regular grid over the specified \code{xlim} and \code{ylim} will be used.}

\item{xlim, ylim}{Numeric vectors of length 2 specifying the range of initial values for the two variables (if \code{data = NULL}).}

\item{breaks}{A numeric value indicating the step size for generating the grid (used if \code{data = NULL}).}

\item{lvparam}{A named list containing four functions:
\describe{
  \item{\code{Lvsef1}}{Self-influence function for variable 1 (e.g., \code{function(x, y)})}
  \item{\code{Lvoth1}}{Other-variable influence function for variable 1}
  \item{\code{Lvsef2}}{Self-influence function for variable 2}
  \item{\code{Lvoth2}}{Other-variable influence function for variable 2}
}}

\item{step_t}{A small numeric value specifying the Euler integration time step (\eqn{\Delta t}).}

\item{Times}{An integer specifying the number of time steps for each trajectory.}

\item{noise}{A numeric value controlling the weight of Gaussian noise added to the rate of change.}

\item{m}{A numeric mean of the noise distribution.}

\item{s}{A numeric standard deviation of the noise distribution.}
}
\value{
A numeric matrix with \code{(Times + 1) * N} rows, where \code{N} is the number of sampled initial conditions.
        The matrix has five columns:
  \itemize{
    \item \code{t} — Time point
    \item \code{lv1} — Value of variable 1
    \item \code{lv2} — Value of variable 2
    \item \code{dl1} — Rate of change for variable 1 at time \code{t}
    \item \code{dl2} — Rate of change for variable 2 at time \code{t}
  }
}
\description{
Simulates the phase field (vector field) of a two-variable dynamical system over a grid of initial conditions.
Each simulation is based on a short trajectory using the Euler method, incorporating user-defined self and other interaction functions.
This is useful for visualizing the phase plane and understanding local system dynamics.
}
\examples{
lvp = list(Lvsef1 = function(x, y) {-0.67 * x}, Lvoth1 = function(x, y) {0.82 * y},
Lvsef2 = function(x, y) {-0.67 * x}, Lvoth2 = function(x, y) {0.82 * y})

inid = expand.grid(x = unique(c(seq(-7, -2, 0.3), seq(-2, 2, 0.15), seq(2, 7, 0.3))),
                   y = unique(c(seq(-7, -2, 0.3), seq(-2, 2, 0.15), seq(2, 7, 0.3))))
df = phaselvr(data = inid, lvparam = lvp, step_t = 0.001, Times = 1)
df = as.data.frame(df)
#define a regular grid
df = df[which(df$t == 0), ]

library(ggplot2)
library(ggquiver)
library(metR)

p = ggplot(df, aes(x = lv1, y = lv2)) +
  geom_streamline(aes(dx = dl1, dy = dl2), color = "blue", linewidth = .2) +
  scale_x_continuous(limits = c(min(inid[, 1]), max(inid[, 1])), expand = c(0, 0)) +
  scale_y_continuous(limits = c(min(inid[, 2]), max(inid[, 2])), expand = c(0, 0)) +
  xlab("R") + ylab("J") +
  theme_bw()
p

}
